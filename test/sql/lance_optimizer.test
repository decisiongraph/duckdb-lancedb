# name: test/sql/lance_optimizer.test
# description: Test Lance query optimizer
# group: [lance]

require lancedb

statement ok
CREATE TABLE vectors (id INT, embedding FLOAT[3]);

statement ok
INSERT INTO vectors VALUES
  (1, [1.0, 0.0, 0.0]),
  (2, [0.0, 1.0, 0.0]),
  (3, [0.0, 0.0, 1.0]),
  (4, [0.5, 0.5, 0.0]);

statement ok
CREATE INDEX idx ON vectors USING LANCE (embedding);

# lance_info() should list the index
query I
SELECT count(*) FROM lance_info();
----
1

# Direct search works
query I
SELECT count(*) FROM lance_search('vectors', 'idx', [1.0, 0.0, 0.0], 2);
----
2

statement ok
DROP INDEX idx;
